# Task: Language-guided Image Retrieval – Stage 1 (Reasoner)

You are given an instruction and a reference image description. Your job is to (Step 1) classify the instruction into atomic operation types and explain the impact on the reference image, and (Step 2) write exactly three one-sentence target descriptions at different semantic granularities.

## Inputs
- Instruction: [[INSTRUCTION]]
- Reference Image: [[REF_IMAGE_DESC]]

## Operation Types (use EXACT labels)
(1) Addition — introduce a new element/feature; specify which existing element it relates to or the placement.
(2) Removal — delete an existing element; specify which one.
(3) Modification — change attributes (color, shape, sleeve length, neckline, length, pattern, fit, etc.); specify the element and how it changes.
(4) Comparison — use words like different/same/more/less/longer/shorter/tighter/looser; specify the element and attribute being compared and the direction.
(5) Retention — explicitly require some elements to stay unchanged; list them.

## Rules
- Base everything on the instruction; use the reference only to borrow NECESSARY adjectives for Step 2 (Enhanced/Comprehensive).
- Do NOT invent elements not mentioned in instruction (except when needed to anchor Addition/Comparison to an existing element from the reference).
- Be atomic: each Step-1 item is exactly a 2-element list: [Type, Impact sentence].
- English sentences, concise, start with an uppercase letter and end with a period.
- Step 2 must contain EXACTLY three strings:
  (1) Core Elements — ONLY elements/adjectives that appear in the instruction.
  (2) Enhanced Details — elements from instruction + necessary adjectives borrowed from the reference.
  (3) Comprehensive Synthesis — elements from instruction + other relevant elements from the reference with necessary adjectives.

## Output format (MANDATORY)
Return ONLY a JSON object (no extra text) with keys "step1" and "step2":
{
  "step1": [
    ["Addition" | "Removal" | "Modification" | "Comparison" | "Retention", "<impact sentence>"],
    ...
  ],
  "step2": [
    "<one sentence for Core Elements>",
    "<one sentence for Enhanced Details>",
    "<one sentence for Comprehensive Synthesis>"
  ]
}

## Mini Example
Instruction: is longer and black with white trim at neck
Reference: The dress is yellow, sleeveless, round neckline, solid, knee-length.
Expected:
{
  "step1": [
    ["Comparison", "Make the dress longer."],
    ["Modification", "Change the dress color to black."],
    ["Addition", "Add white trim at the neck."]
  ],
  "step2": [
    "A long black dress with white trim at the neck.",
    "A long black dress with white trim at the round neckline.",
    "A long, floor-length black dress with a solid pattern, white trim at the round neckline and a sleeveless design."
  ]
}

---
Here is an example:

### Query
 - Instruction: is V-shaped neck and orange with no sleeves and A longer dress with white belt
 - Reference Image: The dress is black with a round neckline, three-quarter sleeves, a solid pattern, and a floor-length design.

### Solve
1. **Step 1.** Based on the instruction:
 - Modification: Change the dress a V-shaped neck.
 - Modification: Change the dress orange.
 - Modification: Change the dress no sleeves design.
 - Comparison: Make dress longer.
 - Addition: Add a white belt to the dress.

2. **Step 2.** Based on step 1, the target image should be like:
 - A long, no sleeves orange dress with a V-shaped neck and no sleeves and a white belt.
 - A long, no sleeves orange dress showing a solid pattern, with a V-shaped neck and no sleeves and a white belt.
 - A long, floor-length, no sleeves orange dress showing a solid pattern, with a V-shaped neck and no sleeves and a white belt.

```json
{
  "step1": [
    ["Modification", "Change the dress a V-shaped neck."],
    ["Modification", "Change the dress orange."],
    ["Modification", "Change the dress no sleeves design."],
    ["Comparison", "Make dress longer."],
    ["Addition", "Add a white belt to the dress."]
  ],
  "step2": [
    "A long, no sleeves orange dress with a V-shaped neck and no sleeves and a white belt.",
    "A long, no sleeves orange dress showing a solid pattern, with a V-shaped neck and no sleeves and a white belt.",
    "A long, floor-length, no sleeves orange dress showing a solid pattern, with a V-shaped neck and no sleeves and a white belt."
  ]
}
```

---
Here is an example:

### Query
 - Instruction: is longer and more formal and is longer and black with white trim at neck
 - Reference Image: The dress is a yellow with a sleeveless design, a round neckline, a solid pattern, knee-length pleats, wide straps, and a slim belt.

### Solve
1. **Step 1.** Based on the instruction:
 - Comparison: Make the dress longer.
 - Comparison: Make the dress more formal.
 - Modification: Change the dress color to black.
 - Addition: Add white trim at the neck.
  
2. **Step 2.** Based on step 1, the target image should be like:
 - A long and formal black dress with white trim at the neck.
 - A long, formal black dress with white trim at the round neckline and a slim belt.
 - A long, floor-length, formal black dress with a solid pattern, white trim at the round neckline, sleeveless design and a slim belt.

```json
{
  "step1": [
    ["Comparison", "Make the dress longer."],
    ["Comparison", "Make the dress more formal."],
    ["Modification", "Change the dress color to black."],
    ["Addition", "Add white trim at the neck."]
  ],
  "step2": [
    "A long and formal black dress with white trim at the neck.",
    "A long, formal black dress with white trim at the round neckline and a slim belt.",
    "A long, floor-length, formal black dress with a solid pattern, white trim at the round neckline, sleeveless design and a slim belt."
  ]
}
```

---
Here is an example:

### Query
 - Instruction: is darker and has longer sleeves and is black and short
 - Reference Image: The dress is white with a sleeveless design, a round neckline, a loose and flowy A-line silhouette, and a knee length.

### Solve
1. **Step 1.** Based on the instruction:
 - Comparison: Make the dress darker.
 - Comparison: Make the sleeves longer.
 - Modification: Change dress color to black.
 - Comparison: Make the dress shorter.
  
2. **Step 2.** Based on step 1, the target image should be like:
 - A short dark black dress with longer sleeves.
 - A short dark black dress with longer sleeves and a round neckline.
 - A short dark black dress with longer sleeves, a round neckline, and a loose and flowy A-line silhouette.

```json
{
  "step1": [
    ["Comparison", "Make the dress darker."],
    ["Comparison", "Make the sleeves longer."],
    ["Modification", "Change dress color to black."],
    ["Comparison", "Make the dress shorter."]
  ],
  "step2": [
    "A short dark black dress with longer sleeves.",
    "A short dark black dress with longer sleeves and a round neckline."
    "A short dark black dress with longer sleeves, a round neckline, and a loose and flowy A-line silhouette."
  ]
}
```

---
Here is an example:

### Query
 - Instruction: has a black belt on waist and brown toned and is a tan color
 - Reference Image: The dress is a orange, strapless dress with a cinched waist and a loose, pleated bodice.

### Solve
1. **Step 1.** Based on the instruction:
 - Addition: Add a black belt on the waist.
 - Modification: Change the dress color to brown tones.
 - Modification: Make the dress tan color.
  
2. **Step 2.** Based on step 1, the target image should be like:
 - A tan and brown strapless dress with a black belt on the waist.
 - A tan and brown strapless dress with a black belt on the cinched waist and a loose bodice.
 - A tan and brown strapless dress with a black belt on the cinched waist, featuring a loose, pleated bodice.

```json
{
  "step1": [
    ["Addition", "Add a black belt on the waist."],
    ["Modification", "Change the dress color to brown tones."],
    ["Modification", "Make the dress tan color."]
  ],
  "step2": [
    "A tan and brown strapless dress with a black belt on the waist.",
    "A tan and brown strapless dress with a black belt on the cinched waist and a loose bodice.",
    "A tan and brown strapless dress with a black belt on the cinched waist, featuring a loose, pleated bodice."
  ]
}
```

---
Here is an example:

### Query
 - Instruction: Is strapless with a looser bottom and has no sleeves and is more wimsy
 - Reference Image: The dress is a sleek, knee-length black piece featuring a short sleeve design with an intricate pattern.

### Solve
1. **Step 1.** Based on the instruction:
 - Modification: Change the dress to strapless design.
 - Comparison: Make the dress bottom looser.
 - Removal: Remove sleeves.
 - Comparison: Make the dress more whimsical.
  
2. **Step 2.** Based on step 1, the target image should be like:
 - A strapless black dress with a loose bottom.
 - A strapless, knee-length black dress with a loose bottom and a whimsical design.
 - A strapless, knee-length black dress with an intricate pattern, a loose bottom and a whimsical design.

```json
{
  "step1": [
    ["Modification", "Change the dress to strapless design."],
    ["Comparison", "Make the dress bottom looser."],
    ["Removal", "Remove sleeves."],
    ["Comparison", "Make the dress more whimsical."]
  ],
  "step2": [
    "A strapless black dress with a loose bottom.",
    "A strapless, knee-length black dress with a loose bottom and a whimsical design.",
    "A strapless, knee-length black dress with an intricate pattern, a loose bottom and a whimsical design."
  ]
}
```

---
Below is the query given to you:

### Query
 - Instruction: [[INSTRUCTION]]
 - Reference Image: [[REF_IMAGE_DESC]]
